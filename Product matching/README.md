# Сопоставление товаров
## Название проекта
  Разработка ML-системы сопоставления товарных позиций с высокой точностью.
### Цель исследования
  Разработать ML-систему для автоматического сопоставления (мэтчинга) товарных позиций с заданной точностью, предназначенную для поддержки следующих бизнес-задач Заказчика:
  - Слияние товарных каталогов от разных поставщиков с устранением дубликатов и несовпадающих наименований
  - Инвентаризация и контроль остатков на складах на основе объединённой номенклатуры
  - Поиск и подбор аналогов для оперативной замены отсутствующих или снятых с продажи товаров
### Задачи исследования
- Загрузить и подготовить данные Заказчика
- Провести анализ и необходимую предобработку датасетов с товарами Заказчика и товарами - аналогами
- В связи с небольшим объемом тестовой выборки синтезировать необходимые данные для обучения
- Обучить разные модели и подобрать оптимальный пайплайн из моделей и их параметров для решения задачи
- Проверить данные на тестовой выборке, рассчитать необходимые метрики.
- Разработать сервис/модуль для Заказчика для запуска проекта
### Запуск модуля
- Создать новую папку и скопировать в нее: config.py, requirements.txt, start.py, папку utils
- Создать папку data, в которую выложить датасет с наименованиями товаров
- Создать новое виртуальное окружение: 
  python -m venv venv
  .\venv\Scripts\Activate
- Установить зависимости:
  pip install -r requirements.txt
### Запуск интерфейса Streamlit
streamlit run start.py
- В случае изменения исходных данных, добавления новых наименований товаров и тп, необходимо оставить в папке data только обновленный датасет, удалить папку models для обучения и создания обновленных моделей
### Используемые технологии
- Python 3.10+
- pandas, numpy, scikit-learn
- BM25 (rank_bm25)
- FastText (предобученные эмбеддинги)
- Streamlit
### Исходные данные
- датасет с наименованиями товаров Заказчика
- датасет со сметченными товарами Заказчика с товарами - аналогами из источника 1
- датасет со сметченными товарами Заказчика с товарами - аналогами из источника 2
### Методология
- Предобработка текстов и генерация синтетических вариантов названий.
- 1 этап - отбор кандидатов с помощью BM25 (Retriever).
- 2 этап - обучение модели и ранжирование кандидатов с использованием FastText (Reranker).
- Оценка качества сопоставления с помощью метрики hits@k.
